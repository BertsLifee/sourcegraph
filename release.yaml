meta:
  productName: sourcegraph
  repository: "github.com/sourcegraph/sourcegraph"
  owners:
    - "@sourcegraph/search"
  artifacts:

requirements:
  - name: "Bazel"
    cmd: bazel version
    fixInstructions: Run `sg setup` and try again.
  - name: "buildozer"
    cmd: buildozer -version
    fixInstructions: Run `go install github.com/bazelbuild/buildtools/buildozer@latest` and try again.
  - name: "Github CLI"
    cmd: gh version
    fixInstructions: brew install gh

create:
  steps:
    patch:
      - name: "generate"
        cmd: |
          bazel run //dev:write_all_generated

      - name: "bazel"
        cmd: |
          bazel run //tools/release:create_patch --run_under="cd $PWD &&" -- {{version}}
