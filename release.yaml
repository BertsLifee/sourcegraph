meta:
  productName: sourcegraph
  repository: "github.com/sourcegraph/sourcegraph"
  owners:
    - "@sourcegraph/search"
  artifacts:

requirements:
  - name: "Bazel"
    cmd: bazel version
    fixInstructions: Run `sg setup` and try again.
  - name: "Github CLI"
    cmd: gh version
    fixInstructions: brew install gh

create:
  steps:
    patch:
      - name: "schemas"
        cmd: |
          bazel run \
            //internal/database:write_frontend_schema_json \
            //internal/database:write_codeinsights_schema_json \
            //internal/database:write_codeintel_schema_json

      - name: "bazel"
        cmd: |
          bazel run //tools/release:create_patch --run_under="cd $PWD &&" -- {{version}}
